# Handel Unsplash API with fetch
با استفاده از Ajax میتونیم اطلاعات مورد نظرمون رو بصورت ناهمزمان یا Asynchronous دریافت کرده و در جای مورد نظرمون قرار بدیم. برای اینکار از XMLHttpRequest استفاده میکنیم و با استفاده از متدهای اون به اطلاعات مورد نظرمون دسترسی پیدا میکنیم.

ویژگی fetch API یک جایگزین مدرن و جدید برای XMLHttpRequest می باشد که کار کردن با Ajax رو خیلی راحتتر و شیرین تر از گذشته میکنه. شما با استفاده از window.fetch که در اکثر مرورگرها پشتیبانی می شود، میتونین درخواستتون رو فرستاده و اطلاعات مورد نظرتون رو بصورت ناهمزمان دریافت کنید.

با توجه به اینکه Fetch API مبتنی بر پرامیس‌ها می‌باشد، مشکل جهنم Callback در این روش خود به خود حل شده است. همچنین بسیاری از جزئیات غیر ضروری و کم کاربرد شئ XMLHttpRequest در این روش حذف شده‌اند. بنابراین اگر برنامه‌های مبتنی بر Ajax با استفاده از Fetch API نوشته شوند. اولاً نیاز به کدنویسی کمتری دارند. ثانیاً خوانایی بسیار بیشتری دارند.

# نحوه‌ی استفاده از Fetch API
برای شروع کار با Fetch API باید از تابع fetch استفاده کنیم. در ساده‌ترین حالت، تابع fetch یک آدرس URL را به عنوان ورودی دریافت می‌کند. سپس یک شئ از نوع Promise را بازمی‌گرداند. دستور زیر نحوه‌ی استفاده از این تابع را نشان می‌دهد.

const p = fetch('http://otedia.com/file.json');

در این دستور تابع fetch یک پرامیس را ایجاد می‌کند و در تابع executor آن، یک درخواست HTTP را به آدرس مشخص شده ارسال می‌کند. سپس پرامیس ایجاد شده را به عنوان نتیجه بازمی‌گرداند. این پرامیس در تابع executor خود، در زمان مناسب توابع resolve و reject را فراخوانی می‌کند. بنابراین برای مدیریت این درخواست HTTP، تنها لازم است که با استفاده از متد then یک تابع را به عنوان تابع onFulfilled تعریف کنیم. همچنین برای مدیریت خطاها نیز می‌توان از متد catch و یک تابع به عنوان تابع onRejected استفاده کرد. قطعه کد زیر نحوه‌ی استفاده از متدهای then و catch را به صورت ساده شده نشان می‌دهد.

p.then((response) => {
		// دستورات مربوط به استفاده از پاسخ دریافت شده
	})
	.catch((error) => {
		// دستورات مدیریت خطا
	});


همانطور که مشاهده می‌کنید هر دو تابع onFulfilled و onRejected یک آرگومان ورودی دریافت می‌کنند. در صورتی که درخواست با موفقیت به پایان برسد یک شئ از نوع Response به تابع onFulfilled ارسال خواهد شد. و در صورتی که ارسال درخواست با خطا مواجه شود، یک شئ از نوع TypeError به تابع onRejected ارسال خواهد شد.

شئ Response دارای تعداد زیادی خاصیت و متد است که جهت دسترسی به پاسخ دریافت شده باید از آنها استفاده کرد. در ادامه به معرفی مهمترین موارد و نحوه‌ی استفاده از آنها خواهیم پرداخت. لیست زیر برخی از خاصیت‌های شئ Response را همراه کاربردشان نشان می‌دهد.

status : کد وضعیت پاسخ (مثلاً 200)
statusText : توضیح کوتاهی در مورد وضعیت پاسخ (مثلاً OK برای کد 200). این خاصیت در حال حاضر فقط در مرورگر Firefox قابل استفاده است.
ok : در صورتی که کد وضعیت بین 200 تا 299 باشد، مقدار این خاصیت true است. در غیر این صورت false است.
url : آدرس URL ارسال کننده‌ی پاسخ.

fetch('https://jsonplaceholder.typicode.com/posts/1')
	.then((response) => {
		console.log(response.status);
		console.log(response.statusText);
		console.log(response.ok);
		console.log(response.url);
	});


 # متد های شی Response

 ## Text method
 ## JSON method
 ## blob method
